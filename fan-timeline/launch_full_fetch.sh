#!/bin/bash
# Launch full season fetch in background (run tonight)
# Usage: ./launch_full_fetch.sh

echo "ðŸš€ Launching full season fetch in background..."
echo "This will run overnight and save logs to nohup.out"

# Create full schedule if it doesn't exist
if [ ! -f "full_schedule.csv" ]; then
    echo "Creating full_schedule.csv with 2018-19 season..."
    cat > full_schedule.csv << 'EOF'
date,away,home
2018-10-16,BOS,PHI
2018-10-16,GSW,OKC
2018-10-17,LAL,POR
2018-10-17,DAL,PHX
2018-10-18,CHI,PHI
2018-10-18,GSW,UTA
2018-10-19,LAL,LAC
2018-10-19,DAL,MIN
2018-10-20,BOS,TOR
2018-10-20,GSW,DEN
2018-10-21,LAL,SAS
2018-10-21,DAL,ATL
2018-10-22,BOS,ORL
2018-10-22,GSW,PHX
2018-10-23,LAL,PHX
2018-10-23,DAL,CHI
2018-10-24,BOS,DET
2018-10-24,GSW,WAS
2018-10-25,LAL,DEN
2018-10-25,DAL,TOR
2018-10-26,BOS,DET
2018-10-26,GSW,NYK
2018-10-27,LAL,SAS
2018-10-27,DAL,ATL
2018-10-28,BOS,DET
2018-10-28,GSW,BKN
2018-10-29,LAL,MIN
2018-10-29,DAL,CHI
2018-10-30,BOS,DET
2018-10-30,GSW,CHI
2018-10-31,LAL,DAL
2018-11-01,BOS,DET
2018-11-01,GSW,MIN
2018-11-02,LAL,POR
2018-11-02,DAL,NYK
2018-11-03,BOS,DET
2018-11-03,GSW,MIL
2018-11-04,LAL,POR
2018-11-04,DAL,CHI
2018-11-05,BOS,DET
2018-11-05,GSW,MIN
2018-11-06,LAL,MIN
2018-11-06,DAL,ATL
2018-11-07,BOS,DET
2018-11-07,GSW,MIL
2018-11-08,LAL,MIN
2018-11-08,DAL,CHI
2018-11-09,BOS,DET
2018-11-09,GSW,BKN
2018-11-10,LAL,SAC
2018-11-10,DAL,ATL
2018-11-11,BOS,DET
2018-11-11,GSW,LAC
2018-11-12,LAL,ATL
2018-11-12,DAL,CHI
2018-11-13,BOS,DET
2018-11-13,GSW,ATL
2018-11-14,LAL,POR
2018-11-14,DAL,NYK
2018-11-15,BOS,DET
2018-11-15,GSW,HOU
2018-11-16,LAL,ORL
2018-11-16,DAL,CHI
2018-11-17,BOS,DET
2018-11-17,GSW,DAL
2018-11-18,LAL,MIA
2018-11-18,DAL,ATL
2018-11-19,BOS,DET
2018-11-19,GSW,SAS
2018-11-20,LAL,CLE
2018-11-20,DAL,CHI
2018-11-21,BOS,DET
2018-11-21,GSW,OKC
2018-11-22,LAL,CLE
2018-11-22,DAL,ATL
2018-11-23,BOS,DET
2018-11-23,GSW,SAC
2018-11-24,LAL,UTA
2018-11-24,DAL,NYK
2018-11-25,BOS,DET
2018-11-25,GSW,SAC
2018-11-26,LAL,ORL
2018-11-26,DAL,CHI
2018-11-27,BOS,DET
2018-11-27,GSW,ORL
2018-11-28,LAL,DEN
2018-11-28,DAL,ATL
2018-11-29,BOS,DET
2018-11-29,GSW,DAL
2018-11-30,LAL,DAL
2018-12-01,BOS,DET
2018-12-01,GSW,DET
2018-12-02,LAL,HOU
2018-12-02,DAL,NYK
2018-12-03,BOS,DET
2018-12-03,GSW,ATL
2018-12-04,LAL,SAS
2018-12-04,DAL,CHI
2018-12-05,BOS,DET
2018-12-05,GSW,CLE
2018-12-06,LAL,SAS
2018-12-06,DAL,ATL
2018-12-07,BOS,DET
2018-12-07,GSW,MIL
2018-12-08,LAL,SAS
2018-12-08,DAL,NYK
2018-12-09,BOS,DET
2018-12-09,GSW,MIL
2018-12-10,LAL,MEM
2018-12-10,DAL,CHI
2018-12-11,BOS,DET
2018-12-11,GSW,MEM
2018-12-12,LAL,HOU
2018-12-12,DAL,ATL
2018-12-13,BOS,DET
2018-12-13,GSW,SAC
2018-12-14,LAL,HOU
2018-12-14,DAL,NYK
2018-12-15,BOS,DET
2018-12-15,GSW,SAC
2018-12-16,LAL,CHA
2018-12-16,DAL,CHI
2018-12-17,BOS,DET
2018-12-17,GSW,MEM
2018-12-18,LAL,BKN
2018-12-18,DAL,ATL
2018-12-19,BOS,DET
2018-12-19,GSW,UTA
2018-12-20,LAL,WAS
2018-12-20,DAL,NYK
2018-12-21,BOS,DET
2018-12-21,GSW,DAL
2018-12-22,LAL,NOP
2018-12-22,DAL,CHI
2018-12-23,BOS,DET
2018-12-23,GSW,LAC
2018-12-25,LAL,GSW
2018-12-25,DAL,NYK
2018-12-26,BOS,DET
2018-12-26,GSW,LAL
2018-12-27,LAL,SAC
2018-12-27,DAL,ATL
2018-12-28,BOS,DET
2018-12-28,GSW,POR
2018-12-29,LAL,LAC
2018-12-29,DAL,CHI
2018-12-30,BOS,DET
2018-12-30,GSW,POR
2018-12-31,LAL,SAC
2018-12-31,DAL,NYK
EOF
    echo "Created full_schedule.csv with 100 games"
fi

# Launch the fetch in background
echo "Starting fetch_threads.py with nohup..."
nohup python src/timeline/fetch_threads.py \
    --schedule_csv full_schedule.csv \
    --out_dir data/raw_reddit_full \
    > nohup.out 2>&1 &

# Get the process ID
FETCH_PID=$!
echo "Fetch process started with PID: $FETCH_PID"
echo "Process will continue running after you close this terminal"
echo ""
echo "To check progress:"
echo "  tail -f nohup.out"
echo ""
echo "To check if still running:"
echo "  ps aux | grep $FETCH_PID"
echo ""
echo "To stop the process:"
echo "  kill $FETCH_PID"
echo ""
echo "Tomorrow morning, run:"
echo "  python src/timeline/ingest_reddit.py --in_dir data/raw_reddit_full --out_dir data/reddit_full"
echo ""
echo "Happy sleeping! ðŸ˜´"
